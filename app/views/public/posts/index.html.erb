<h1>投稿一覧</h1>

<% @posts.each do |post| %>
<div>
  <%= link_to customer_path(post.customer.id) do %>
  <p>投稿ユーザー画像：<%= image_tag post.customer.get_profile_image(100,100) %></p>
  <% end %>
  <p>ユーザーネーム：<%= post.customer.account_name %></p>
  <p>ユーザー居住地：<%= post.customer.spot.spot_name_i18n %></p>

<div class="container">
        <div id="carouselExampleControls_<%= post.id %>" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          <% post.get_images.each_with_index do |image, index| %>
          <div class="carousel-item<%= index == 0 ? ' active' : ''%>">
            <%= image_tag image, style: 'width: 100%; height: 500px; object-fit: cover;' %>
          </div>
          <% end %>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls_<%= post.id %>" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls_<%= post.id %>" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
</div>
<%= link_to post_path(post) do %>
  <p>タイトル:<%= post.title %></p>
  <% end %>
  <!--<p>説明：<%#post.post_content %></p>-->
  <p>遊んだ場所：<%= post.spot.spot_name_i18n %></p>
  <div id="rate_<%= post.id %>"></div>
<script>
$(function(){

    let raty_<%= post.id %> = document.querySelector('#rate_<%= post.id %>');
    rate_<%= post.id %>.innerHTML = ""
    let option_<%= post.id %> = {
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        starHalf: "<%= asset_path('star-half.png') %>",
        score: "<%= post.rate %>",
        readOnly: true,
      };
    raty(raty_<%= post.id %> ,option_<%= post.id %>);
});
</script>

  <% if post.favorited_by?(current_customer) %>

    <%= link_to post_favorites_path(post), method: :delete do %>
      ♥<%= post.favorites.count %> いいね
    <% end %>
    <% else %>
    <%= link_to post_favorites_path(post), method: :post do %>
      ♡<%= post.favorites.count %> いいね
    <% end %>
  <% end %>
   <p><%= link_to "#{post.comments.count} コメント", post_path(post.id) %></p>

</div>

<% end %>

<p><%= link_to"HOMEに戻る",root_path %> </p>

<%= paginate @posts %>
