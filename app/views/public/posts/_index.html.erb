

<% if tags.present? %>
  <% tags.each do |tag| %>
    <%= link_to "#{tag.name}(#{tag.taggings_count})", posts_path(tag_name: tag.name) %>
  <% end %>
<% else %>
 <p> 登録されているタグはありません </p>
 <% end %>

<% if tag.present? %>
  <p>"<%= tag %>"の検索結果</p>
<% end %>

<% posts.each do |post| %>
<div class="text-center">

<div class="card w-50 mx-auto mt-4 shadow-lg">
  <%= link_to customer_path(post.customer.id) do %>
  <p>投稿ユーザー画像：<%= image_tag post.customer.get_profile_image(100,100) %></p>
  <% end %>
  <p>ユーザーネーム：<%= post.customer.account_name %></p>
  <p>ユーザー居住地：<%= post.customer.spot.spot_name_i18n %></p>

<div class="container">
        <div id="carouselExampleControls_<%= post.id %>" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          <% post.get_images.each_with_index do |image, index| %>
          <div class="carousel-item<%= index == 0 ? ' active' : ''%>">
            <%= image_tag image, style: 'width: 100%; height: 500px; object-fit: cover;' %>
          </div>
          <% end %>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls_<%= post.id %>" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls_<%= post.id %>" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
</div>
<div class="card-body">
<%= link_to post_path(post) do %>
  <p>タイトル:<%= post.title %></p>
  <% end %>
  <!--<p>説明：<%#post.post_content %></p>-->
  <p>遊んだ場所：<%= post.spot.spot_name_i18n %></p>

     <p>タグ一覧：<% post.tag_list.each do |tag| %>
   <span class="badge badge-primary mr-1 p-2 ">
     <%= link_to posts_path(tag_name: tag) ,class:"text-white" do %>
       <%= tag %>
     <% end %></span>
   <% end %></p>



  <div id="rate_<%= post.id %>"></div>
<script>
$(function(){

    let raty_<%= post.id %> = document.querySelector('#rate_<%= post.id %>');
    rate_<%= post.id %>.innerHTML = ""
    let option_<%= post.id %> = {
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        starHalf: "<%= asset_path('star-half.png') %>",
        score: "<%= post.rate %>",
        readOnly: true,
      };
    raty(raty_<%= post.id %> ,option_<%= post.id %>);
});
</script>

        <div class=<%= "favorite-" + post.id.to_s %> >
            <%= render "public/favorites/btn", post: post %>
        </div>


   <p><%= link_to "#{post.comments.count} コメント", post_path(post.id) %></p>

</div>
</div>
</div>
<% end %>

<p><%= link_to"HOMEに戻る",root_path %> </p>